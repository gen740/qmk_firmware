#!python3

import re


KEYMAPPING_FILE = "./dvorak.txt"


TEST_STRING = """
┏━━━━━┳━━━━━┳━━━━━┳━━━━━┳━━━━━┓                     ┏━━━━━┳━━━━━┳━━━━━┳━━━━━┳━━━━━┓
┃  '  ┃  ,  ┃  .  ┃  p  ┃  y  ┃                     ┃  f  ┃  g  ┃  c  ┃  r  ┃  l  ┃
┣━━━━━╋━━━━━╋━━━━━╋━━━━━╋━━━━━┫                     ┣━━━━━╋━━━━━╋━━━━━╋━━━━━╋━━━━━┫
┃  a  ┃  o  ┃  e  ┃  u  ┃  i  ┃                     ┃  d  ┃  h  ┃  t  ┃  n  ┃  s  ┃
┣━━━━━╋━━━━━╋━━━━━╋━━━━━╋━━━━━┫                     ┣━━━━━╋━━━━━╋━━━━━╋━━━━━╋━━━━━┫
┃  ;  ┃  q  ┃  j  ┃  k  ┃  x  ┃                     ┃  b  ┃  m  ┃  w  ┃  v  ┃  z  ┃
┗━━━━━┻━━━━━┻━━━┳━┻━━━┳━┻━━━┳━┻━━━┓             ┏━━━┻━┳━━━┻━┳━━━┻━┳━━━┻━━━━━┻━━━━━┛
                ┃     ┃ <s> ┃     ┃             ┃     ┃ <r> ┃     ┃
                ┗━━━━━┻━━━━━┻━━━━━┛             ┗━━━━━┻━━━━━┻━━━━━┛
"""


BORDER_CHARS = ["┏", "┳", "┓", "┃", "┣", "┫", "╋", "┗", "┻", "┛"]


pattern = re.compile(
    r"""┏━*┳━*┳━*┳━*┳━*┓\s*┏━*┳━*┳━*┳━*┳━*┓
┃([^┃]*)┃([^┃]*)┃([^┃]*)┃([^┃]*)┃([^┃]*)┃\s*┃([^┃]*)┃([^┃]*)┃([^┃]*)┃([^┃]*)┃([^┃]*)┃
┣━*╋━*╋━*╋━*╋━*┫\s*┣━*╋━*╋━*╋━*╋━*┫
┃([^┃]*)┃([^┃]*)┃([^┃]*)┃([^┃]*)┃([^┃]*)┃\s*┃([^┃]*)┃([^┃]*)┃([^┃]*)┃([^┃]*)┃([^┃]*)┃
┣━*╋━*╋━*╋━*╋━*┫\s*┣━*╋━*╋━*╋━*╋━*┫
┃([^┃]*)┃([^┃]*)┃([^┃]*)┃([^┃]*)┃([^┃]*)┃\s*┃([^┃]*)┃([^┃]*)┃([^┃]*)┃([^┃]*)┃([^┃]*)┃
┗━*┻━*┻━*┳━┻━*┳━┻━*┳━┻━*┓\s*┏━*┻━┳━*┻━┳━*┻━┳━*┻━*┻━*┛
\s*┃([^┃]*)┃([^┃]*)┃([^┃]*)┃\s*┃([^┃]*)┃([^┃]*)┃([^┃]*)┃
\s*┗━*┻━*┻━*┛\s*┗━*┻━*┻━*┛""",
    re.DOTALL,
)


def parse_mapping(keymap_str: str):
    matches = re.match(pattern, keymap_str)
    if matches is None:
        raise ValueError("Invalid keymap string")
    return list(map(lambda x: x.strip(), matches.groups()))
